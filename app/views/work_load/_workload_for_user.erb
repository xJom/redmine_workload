<%
# Renders the workload data for one single user.
# Parameters:
#  * workload: The data to render. A UserWorkload instance.
  user = workload.user
%>

<tbody class="user-total-workload" id="user-total-workload-<%= user.id %>">
  <tr>
  <th class="user-description" scope="row" title="<%= l(:workload_trigger_tooltip) %>">
    <%= render :partial => 'trigger', :locals => {:trigger_for => "user-#{user.id}"} %>
    <%= user.name %>
    <% if workload.overdue_number > 0 %>
    <dl class="additional-user-info user-<%= user.id %>-open user-<%= user.id %>-close">
      <dt><%= l(:workload_overdue_issues_num) %></dt>
      <dd><%= workload.overdue_number %></dd>
      <dt><%= l(:workload_overdue_issues_hours) %></dt>
      <dd><%= "%0.2f" % workload.overdue_hours %></dd>
    </dl>
    <% end %>
  </th>
  <% # Print the total workload for this user for each day %>
  <%= render partial: 'total_workload', locals: { workload: workload } %>
  </tr>
</tbody>

<% unless workload.invisible_issue_workload.empty? %>
  <tbody class="invisible-issues-summary user-<%= user.id %>-open user-<%= user.id %>-close">
  <tr>
    <th class="invisible-workload-description" scope="row"><%= l(:workload_show_invisible_issues) %> </th>
    <%= render partial: 'summarized_workload_for_invisible_issues',
               locals: { user: user,
                         workload: workload.invisible_issue_workload } %>
  </tr>
  </tbody>
<% end %>
<% # Iterate over all projects for the user %>
<% workload.project_workloads.each do |project, data| %>
  <%= render partial: 'workload_for_project',
             locals: { user: user, project: project, data: data, overdue: workload.project_overdues[project] } %>
<% end %>
